<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GraphQL Profile</title>
  <link rel="icon" href="data:," />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="top">
    <div class="brand">GraphQL Profile</div>
    <button id="logoutBtn" class="btn ghost" hidden>Logout</button>
  </header>

  <main class="wrap">

    <!-- LOGIN VIEW -->
    <section id="loginView" class="card">
      <h1>Login</h1>
      <p class="muted">Enter username/email and password to get a JWT.</p>

      <form id="loginForm" class="form" autocomplete="on">
        <label>
          Username / Email
          <input id="identifier" autocomplete="username" placeholder="Enter your username or email." />
        </label>

        <label>
          Password
          <input id="password" type="password" autocomplete="current-password" placeholder="Enter your password." />
        </label>

        <button class="btn primary" type="submit">Login</button>
        <div id="loginError" class="error"></div>
      </form>
    </section>

    <!-- PROFILE VIEW -->
    <section id="profileView" hidden>

      <!-- HERO / PROFILE CARD -->
      <div class="card" style="display:flex; gap:18px; align-items:center;">
        <div style="
          width:70px;height:70px;border-radius:18px;
          background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(6,182,212,.80));
          display:flex;align-items:center;justify-content:center;
          font-weight:900;font-size:26px; letter-spacing:.5px;">
          <span id="avatarInitials">AR</span>
        </div>

        <div style="flex:1;">
          <h1 style="margin-bottom:6px;">
            <span id="fullName">Student Profile</span>
          </h1>
          <div class="muted" style="display:flex;gap:14px;flex-wrap:wrap;">
            <span class="badge">Login: <span id="pLogin">—</span></span>
            <span class="badge">User ID: <span id="pId">—</span></span>
            <span class="badge">Total XP: <span id="xpTotal">—</span></span>
          </div>
        </div>
      </div>

      <!-- SMALL STATS ROW -->
      <div class="grid" style="margin-top:16px;">
        <div class="card">
          <h2>Total XP</h2>
          <div class="big" id="xpBig">—</div>
          <div class="muted" id="xpMeta">—</div>
        </div>

        <div class="card">
          <h2>Audit ratio</h2>
          <div class="big" id="auditBig">—</div>
          <div class="muted">Up: <span id="audUp">—</span> • Down: <span id="audDown">—</span></div>
        </div>

        <div class="card">
          <h2>Pass / Fail</h2>
          <div class="big" id="pfBig">—</div>
          <div class="muted">
            Pass: <span id="pfPass">—</span> • Fail: <span id="pfFail">—</span>
          </div>
        </div>
      </div>

      <!-- STATISTICS -->
      <div style="display:flex;align-items:center;justify-content:space-between;margin-top:22px;">
        <h1 style="font-size:18px;margin:0;">Statistics</h1>
        <span class="badge">SVG Charts</span>
      </div>

      <div class="grid" style="margin-top:12px;">
        <div class="card">
          <h2>XP over time</h2>
          <p class="muted" style="margin-top:-4px;margin-bottom:10px;">
            Cumulative XP growth (transactions type: <b>xp</b>).
          </p>
          <svg id="xpChart" aria-label="XP over time chart"></svg>
        </div>

        <div class="card">
          <h2>Top projects XP</h2>
          <p class="muted" style="margin-top:-4px;margin-bottom:10px;">
            Sum of XP grouped by <b>path</b> (Top 10).
          </p>
          <div id="topChartWrap" style="max-height:260px; overflow:auto; border-radius:14px;">
            <svg id="topChart" aria-label="Top projects XP chart"></svg>
          </div>
        </div>

        <div class="card">
          <h2>Pass / Fail ratio</h2>
          <p class="muted" style="margin-top:-4px;margin-bottom:10px;">
            Based on <b>progress</b> table grades (grade 1 = pass, grade 0 = fail).
          </p>
          <svg id="pfChart" class="mini" aria-label="Pass Fail chart"></svg>
        </div>

        <div class="card">
          <h2>Audit done vs received</h2>
          <p class="muted" style="margin-top:-4px;margin-bottom:10px;">
            Based on transaction types <b>up</b> and <b>down</b>.
          </p>
          <svg id="auditChart" class="mini" aria-label="Audit chart"></svg>
        </div>
      </div>

    </section>
  </main>

  <script type="module" src="./app.js"></script>
</body>
</html>